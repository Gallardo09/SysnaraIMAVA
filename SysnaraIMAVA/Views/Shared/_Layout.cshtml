@using Microsoft.AspNetCore.Http
@{
    // Obtén el tipo de usuario desde la sesión
    var userType = Context.Session.GetString("Role");
}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>@ViewData["Title"] Sistema Sysnara</title>
    <link rel="stylesheet" href="~/lib/bootstrap/dist/css/bootstrap.min.css" />
    <link rel="stylesheet" href="~/css/home.css" asp-append-version="true" />
    @* Bordes Neon *@
    <link rel="stylesheet" href="~/css/bordesneon.css" />
    @*Enlace Fontawesome Iconos*@
    <link rel="stylesheet" href="~/lib/font-awesome/css/all.min.css" />
    @*Enlace a archivos Line Awesome Iconos*@
    <link rel="stylesheet" href="~/lib/line-awesome-1.3.0/css/line-awesome.min.css" />

    @*Enlace a archivos datatables*@
    <link rel="stylesheet" href="~/css/cloudflare.bootstrap.min.css" />
    <link rel="stylesheet" href="~/css/dataTables.bootstrap5.css" />

    <link rel="stylesheet" href="~/css/site.css" asp-append-version="true" />
    <link rel="stylesheet" href="~/SystemSysnara.styles.css" asp-append-version="true" />

    <!-- Enlace al archivo CSS de Toastr -->
    <link href="~/lib/toastr.js/toastr.min.css" rel="stylesheet" />

    @* fuentes de google  *@
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Russo+One&display=swap" rel="stylesheet">
    <!-- ... (existing head content) ... -->
    <style>
        .navbar-nav .nav-item {
            display: inline-block;
            width: auto;
            text-align: center;
            margin-right: 10px;
        }
        .navbar-nav .nav-link {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 10px;
            border-radius: 5px;
            transition: all 0.3s ease;
        }
        .navbar-nav .nav-link i {
            font-size: 1.2em;
            margin-bottom: 0.2em;
        }
        .navbar-nav .nav-link span {
            font-size: 0.8em;
        }
        .navbar-nav .nav-link:hover,
        .navbar-nav .nav-link.active {
            background-color: #f0f0f0;
            color: #007bff !important;
        }

        /* dropdown DE NOTAS  */
        /* Mostrar el dropdown de forma más fluida */
        .dropdown-menu {
            display: none; /* Lo ocultamos inicialmente */
            opacity: 0;
            transition: opacity 0.3s ease-in-out;
        }

            /* Cuando el dropdown está visible */
            .dropdown-menu.show {
                display: block;
                opacity: 1;
            }
        /* Evitar que los enlaces activos se vuelvan azules */
        .navbar-nav .nav-link.active {
            color: black !important; /* Restablecer color a negro para el enlace activo */
            background-color: transparent !important; /* Evitar fondo de color azul o cualquier otro color */
        }
    </style>

    <!-- Modal para selección de sistema de Imprimir notas Y reportes-->
    <style>
        /* Efectos y estilos para el modal mejorado */
        .bg-gradient-primary {
            background: linear-gradient(135deg, #3a7bd5 0%, #00d2ff 100%);
        }

        .bg-gradient-info {
            background: linear-gradient(135deg, #4776E6 0%, #8E54E9 100%);
        }

        .hvr-grow {
            transform: perspective(1px) translateZ(0);
            transition: all 0.3s ease;
        }

            .hvr-grow:hover {
                transform: scale(1.03);
                box-shadow: 0 10px 20px rgba(0,0,0,0.1) !important;
            }

        .modal-content {
            border: none;
            box-shadow: 0 5px 30px rgba(0,0,0,0.2);
        }

        .btn-rounded {
            border-radius: 50px;
        }

        .card {
            transition: all 0.3s cubic-bezier(.25,.8,.25,1);
        }

            .card:hover {
                box-shadow: 0 14px 28px rgba(0,0,0,0.1), 0 10px 10px rgba(0,0,0,0.08);
            }
    </style>
</head>
<body>
    @* ********************************** INICIO DEL SPINNER ********************************************************************************************** *@
    <!-- Spinner -->
    <div id="spinner">
        <img src="~/Recursos/home.png" alt="Cargando..." id="spinner-image" />
    </div>

    <!-- Estilos para el spinner -->
    <style>
        #spinner {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(255, 255, 255, 0.8); /* Fondo semitransparente */
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 10000; /* Asegura que esté por encima de todo */
        }

        #spinner-image {
            width: 250px; /* Ajusta el tamaño de la imagen */
            height: 250px;
            animation: spin 1s linear infinite; /* Animación de rotación horizontal */
        }

        @@keyframes spin {
            0% {
                transform: rotateY(0deg); /* Inicia sin rotación */
            }

            100% {
                transform: rotateY(360deg); /* Gira 360 grados en el eje Y */
            }
        }
    </style>

    <!-- Script para mostrar y ocultar el spinner -->
    <script>
        // Mostrar el spinner inmediatamente
        document.getElementById("spinner").style.display = "flex";

        // Ocultar el spinner cuando la página ha terminado de cargar, pero con un retraso mínimo
        window.addEventListener("load", function () {
            // Establecer un retraso mínimo de 1 segundo (1000 milisegundos)
            setTimeout(function () {
                document.getElementById("spinner").style.display = "none";
            }, 1000); // Cambia este valor para ajustar el tiempo mínimo de visualización
        });
    </script>
    @* ********************************** FIN DEL SPINNER ***********************************************************************************************@

    @if (string.IsNullOrEmpty(userType))
    {
        <!-- Mostrar formulario de login -->
        @RenderBody()  <!-- Aquí se renderiza la vista de Login -->
    }
    else
    {
        <header>
            <nav class="navbar navbar-expand-sm navbar-toggleable-sm navbar-light bg-white border-bottom box-shadow mb-3" style="font-size: 15px">
                <div class="container-fluid">
                    <a class="navbar-brand" asp-area="" asp-controller="" asp-action="" onclick="event.preventDefault()">Sistema Sysnara</a>
                    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target=".navbar-collapse" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                        <span class="navbar-toggler-icon"></span>
                    </button>

                    <div class="navbar-collapse collapse d-sm-inline-flex justify-content-between">
                        <ul class="navbar-nav flex-grow-1">
                            @if (userType == "Administrador")
                            {
                                <li class="nav-item">
                                    <a class="nav-link text-dark" asp-area="" asp-controller="Home" asp-action="Index">
                                        <i class="fa-solid fa-school"></i> Principal
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link text-dark" asp-area="" asp-controller="Año" asp-action="Index">
                                        <i class="fa-regular fa-calendar-check"></i> Año
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link text-dark" asp-area="" asp-controller="Docentes" asp-action="Index">
                                        <i class="fa-solid fa-chalkboard-user"></i> Docentes
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link text-dark" asp-area="" asp-controller="Grado" asp-action="Index">
                                        <i class="fa-solid fa-puzzle-piece"></i> Grados
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link text-dark" asp-area="" asp-controller="Asignaturas" asp-action="Index">
                                        <i class="fa-solid fa-file-contract"></i> Asignaturas
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link text-dark" asp-area="" asp-controller="Padres" asp-action="Index">
                                        <i class="fa-solid fa-person-breastfeeding"></i> Padres
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link text-dark" asp-area="" asp-controller="Matricula" asp-action="Index">
                                        <i class="fa-solid fa-graduation-cap"></i> Matricula
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link text-dark" href="#" data-bs-toggle="modal" data-bs-target="#reportModal">
                                        <i class="fa-solid fa-layer-group"></i> Reportes
                                    </a>
                                </li>
                                <li class="nav-item dropdown">
                                    <a class="nav-link text-dark dropdown-toggle" href="#" id="navbarDropdown" role="button" aria-expanded="false">
                                        <i class="fa-solid fa-star-half-stroke"></i> Notas
                                    </a>
                                    <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
                                        <!-- Ingresar Notas -->
                                        <li>
                                            <a class="dropdown-item" asp-area="" asp-controller="Notas" asp-action="Index">
                                                <i class="fa-solid fa-star-half-stroke"></i> Ingresar Notas
                                            </a>
                                        </li>
                                        <!-- Opción Personalidad -->
                                        <li>
                                            <a class="dropdown-item" asp-area="" asp-controller="" asp-action="" id="btnPersonalidadDropdown">
                                                <i class="fa-solid fa-person-circle-check"></i> Personalidad
                                            </a>
                                        </li>
                                        <!-- Opción Imprimir Notas -->
                                        <li>
                                            <a class="dropdown-item" asp-area="" asp-controller="" asp-action="" data-bs-toggle="modal" data-bs-target="#notasSystemModal">
                                                <i class="fa-solid fa-print"></i> Imprimir Notas
                                            </a>
                                        </li>
                                        <!-- Opción Generar CUADRO DE HONOR -->
                                        <li>
                                            <a class="dropdown-item" asp-area="" asp-controller="CuadroHonor" asp-action="Index">
                                                <i class="fa-solid fa-award"></i> Cuadro Honor
                                            </a>
                                        </li>
                                    </ul>
                                </li>
                                <!-- VISTA DESDE EL ADMINISTRADOR -->
                                <li class="nav-item dropdown">
                                    <a class="nav-link text-dark dropdown-toggle" href="#" id="navbarDropdownTeacher" role="button" aria-expanded="false">
                                        <i class="fa-solid fa-chalkboard-user"></i> Maestro
                                    </a>
                                    <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
                                        <li>
                                            <a class="dropdown-item" asp-area="" asp-controller="Books" asp-action="Index">
                                                <i class="fa-solid fa-book"></i> Libros
                                            </a>
                                        </li>
                                        <li>
                                            <a class="dropdown-item" asp-area="" asp-controller="Recursos" asp-action="Index">
                                                <i class="fa-solid fa-chalkboard-user"></i> Recursos
                                            </a>
                                        </li>
                                        <li>
                                            <a class="dropdown-item" asp-area="" asp-controller="Formative" asp-action="Index">
                                                <i class="fa-solid fa-file-contract"></i> Pruebas Formativas
                                            </a>
                                        </li>
                                        <li>
                                            <a class="dropdown-item" asp-area="" asp-controller="Diagnostic" asp-action="Index">
                                                <i class="fa-solid fa-check-double"></i> Pruebas Diagnósticas
                                            </a>
                                        </li>
                                        <li>
                                            <a class="dropdown-item" asp-area="" asp-controller="Tareas" asp-action="Index">
                                                <i class="fa-solid fa-list-check"></i> Tareas
                                            </a>
                                        </li>
                                    </ul>
                                </li>
                                @* Tutorial / Información del Desarrollador *@
                                <li class="nav-item">
                                    <a class="nav-link text-dark" asp-area="" asp-controller="Estadistica" asp-action="Index">
                                        <i class="fa-solid fa-chart-line"></i> Estadística
                                    </a>
                                </li>
                                <!-- Otras opciones para Admin -->
                            }
                            else if (userType == "Teacher" || userType == "Kindergarten" || userType == "Preparatory" || userType == "First" || userType == "Second" ||
                            userType == "Third" || userType == "Fourth" || userType == "Fifth" || userType == "Sixth" || userType == "Seventh" ||
                            userType == "Eighth" || userType == "Ninth" || userType == "Tenth" || userType == "Eleventh" || userType == "Twelfth")
                            {
                                <li class="nav-item">
                                    <a class="nav-link text-dark" asp-area="" asp-controller="Home" asp-action="IndexTeacher">
                                        <i class="fa-solid fa-school"></i> Principal
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link text-dark" asp-area="" asp-controller="Books" asp-action="Index">
                                        <i class="fa-solid fa-book"></i> Books
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link text-dark" asp-area="" asp-controller="Recursos" asp-action="Index">
                                        <i class="fa-solid fa-chalkboard-user"></i> Recursos
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link text-dark" asp-area="" asp-controller="Formative" asp-action="Index">
                                        <i class="fa-solid fa-file-contract"></i> Pruebas Formativas
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link text-dark" asp-area="" asp-controller="Diagnostic" asp-action="Index">
                                        <i class="fa-solid fa-check-double"></i> Pruebas Diagnósticas
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link text-dark" asp-area="" asp-controller="Instructivos" asp-action="Index">
                                        <i class="fa-solid fa-person-chalkboard"></i> Instructivos
                                    </a>
                                </li>
                            }
                        </ul>

                        <!-- Zona de usuario -->
                        <ul class="navbar-nav ml-auto">
                            <li class="nav-item">
                                <a class="nav-link text-dark">
                                    <i class="fa-solid fa-user-tie"></i> @userType
                                </a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link text-dark" asp-controller="Home" asp-action="Logout">
                                    <i class="fa-solid fa-sign-out-alt"></i> Salir
                                </a>
                            </li>
                        </ul>
                    </div>
                </div>
            </nav>
        </header>

        <div class="container-fluid" style="font-size: 13.5px">
            <main role="main" class="pb-3">
                @RenderBody()
            </main>
        </div>
    }

    <!-- Inicio Spinner -->
    <!-- Fin Spinner -->

    @*     <footer class="border-top footer text-muted">
        <div class="container">
            &copy; 2024 - SystemSysnara - <a asp-area="" asp-controller="Home" asp-action="Privacy">Contacto</a>
        </div>
    </footer> *@

    @* Version completa de jquery INICIO *@
    <script src="~/lib/jquery/jquery.slim.min.js"></script>
    <script src="~/lib/jquery/dist/jquery.min.js"></script>

    @* FIN *@
    <script src="~/lib/jquery-validation/dist/jquery.validate.min.js"></script>
    <script src="~/lib/jquery-validation-unobtrusive/jquery.validate.unobtrusive.min.js"></script>
    <script src="~/lib/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
    <script src="~/js/site.js" asp-append-version="true"></script>
    @* AGRAGADOS / COMPLEMENTARIOS *@
    <script src="~/lib/font-awesome/js/fontawesome.min.js"></script>
    <!-- Incluye el archivo JavaScript de DataTables -->
    <script src="~/lib/bootstrap/dist/js/bootstrap5.3.bundle.min.js"></script>
    <script src="~/lib/datatables.net/jquery.dataTables2.0.5.js"></script>
    <!-- Incluye el archivo JavaScript de DataTables para Bootstrap 5 -->
    <script src="~/lib/datatables.net/dataTables.bootstrap5.js"></script>

    <!-- Incluye el archivo SweetAlert -->
    <script src="~/lib/SweetAlert2/sweetalert2_11.10.8.js"></script>

    <!-- Enlace al archivo JS de Toastr -->
    <script src="~/lib/toastr.js/toastr.min.js"></script>

    <!-- Script para manejar el botón de retroceso del navegador -->
    <script>
        // Verificar si el usuario está autenticado
        function checkSession() {
            // Solo verificar la sesión si no estamos en la página de Login
            if (window.location.pathname.toLowerCase() !== '/home/login') {
                fetch('/Home/CheckSession') // Endpoint para verificar la sesión
                    .then(response => response.json())
                    .then(data => {
                        if (!data.isAuthenticated) {
                            // Si no está autenticado, redirigir al login
                            window.location.href = '@Url.Action("Login", "Home")';
                        }
                    })
                    .catch(error => {
                        console.error('Error al verificar la sesión:', error);
                    });
            }
        }

        // Detectar cuando el usuario retrocede
        window.onpageshow = function(event) {
            if (event.persisted) { // Si la página se carga desde la caché
                checkSession(); // Verificar la sesión
            }
        };

        // Verificar la sesión al cargar la página
        document.addEventListener('DOMContentLoaded', function() {
            checkSession();
        });
    </script>


    <!-- DataTables -->
    <script>
        new DataTable('#example', {
            scrollX: true,
            scrollY: 300,

        });
    </script>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const navLinks = document.querySelectorAll('.navbar-nav .nav-link');

            // Function to update active state
            function updateActiveState() {
                const currentPath = window.location.pathname;
                navLinks.forEach(link => {
                    if (link.getAttribute('href') === currentPath) {
                        link.classList.add('active');
                    } else {
                        link.classList.remove('active');
                    }
                });
            }

            // Initial update
            updateActiveState();

            // Update on click
            navLinks.forEach(link => {
                link.addEventListener('click', function() {
                    navLinks.forEach(l => l.classList.remove('active'));
                    this.classList.add('active');
                });
            });
        });
    </script>

    <!-- Modal para selección de reportes -->
    <div class="modal fade" id="reportModal" tabindex="-1" aria-labelledby="reportModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg modal-dialog-centered">
            <div class="modal-content border-0 shadow-lg" style="border-radius: 15px; overflow: hidden;">
                <div class="modal-header bg-success text-white">
                    <h4 class="modal-title w-100 text-center" id="reportModalLabel">
                        <i class="fas fa-layer-group me-2"></i>Seleccione el Tipo de Reporte
                    </h4>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body p-4">
                    <div class="row g-4">
                        <!-- Formato Tradicional -->
                        <div class="col-md-6">
                            <div class="card h-100 border-0 shadow-sm hvr-grow" style="border-radius: 12px; cursor: pointer; transition: all 0.3s ease;" id="tradicionalCard">
                                <div class="card-header bg-gradient-success text-white text-center py-3" style="border-radius: 12px 12px 0 0;">
                                    <h5 class="mb-0">
                                        <i class="fas fa-flag me-2"></i>FORMATO TRADICIONAL
                                    </h5>
                                </div>
                                <div class="card-body text-center d-flex flex-column">
                                    <div class="my-3">
                                        <img src="/Recursos/honduras.jpg" class="img-fluid rounded" alt="Bandera de Honduras" style="max-height: 120px; border: 2px solid #e9ecef;">
                                    </div>
                                    <p class="text-muted mb-4">
                                        <i class="fas fa-info-circle me-2"></i>Reportes basados en el sistema educativo nacional
                                    </p>
                                    <div class="mt-auto">
                                        <button class="btn btn-success px-4 rounded-pill" id="tradicionalBtn">
                                            <i class="fas fa-check me-2"></i>Seleccionar
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Formato Anglosajón -->
                        <div class="col-md-6">
                            <div class="card h-100 border-0 shadow-sm hvr-grow" style="border-radius: 12px; cursor: pointer; transition: all 0.3s ease;" id="anglosajonCard">
                                <div class="card-header bg-gradient-warning text-white text-center py-3" style="border-radius: 12px 12px 0 0;">
                                    <h5 class="mb-0">
                                        <i class="fas fa-globe me-2"></i>FORMATO ANGLOSAJÓN
                                    </h5>
                                </div>
                                <div class="card-body text-center d-flex flex-column">
                                    <div class="my-3">
                                        <img src="/Recursos/eeuu.jpg" class="img-fluid rounded" alt="Bandera de USA" style="max-height: 120px; border: 2px solid #e9ecef;">
                                    </div>
                                    <p class="text-muted mb-4">
                                        <i class="fas fa-info-circle me-2"></i>Reportes basados en el sistema educativo internacional
                                    </p>
                                    <div class="mt-auto">
                                        <button class="btn btn-warning px-4 rounded-pill text-white" id="anglosajonBtn">
                                            <i class="fas fa-check me-2"></i>Seleccionar
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer bg-light">
                    <button type="button" class="btn btn-outline-secondary rounded-pill" data-bs-dismiss="modal">
                        <i class="fas fa-times me-2"></i>Cerrar
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de selección de parcial de PERSONALIDAD -->
    <div class="modal fade" id="parcialModal" tabindex="-1" aria-labelledby="parcialModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="parcialModalLabel">Seleccione un PARCIAL de la PERSONALIDAD</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <label for="parcialSelect">Elija un Parcial:</label>
                    <select class="form-select" id="parcialSelect">
                        <option value="1">I Parcial</option>
                        <option value="2">II Parcial</option>
                        <option value="3">III Parcial</option>
                        <option value="4">IV Parcial</option>
                    </select>
                </div>
                <div class="modal-footer d-flex justify-content-evenly w-100">
                    <div class="col-5">
                        <button type="button" class="btn btn-secondary w-100" data-bs-dismiss="modal">
                            <i class="fas fa-times"></i> Cerrar
                        </button>
                    </div>
                    <div class="col-5">
                        <button type="button" class="btn btn-primary w-100" id="btnSeleccionarParcial">
                            <i class="fas fa-check"></i> Seleccionar
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>


    <!-- Modal para selección de sistema de notas -->
    <div class="modal fade" id="notasSystemModal" tabindex="-1" aria-labelledby="notasSystemModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg modal-dialog-centered">
            <div class="modal-content border-0 shadow-lg" style="border-radius: 15px; overflow: hidden;">
                <div class="modal-header bg-primary text-white">
                    <h4 class="modal-title w-100 text-center" id="notasSystemModalLabel">
                        <i class="fas fa-print me-2"></i>Seleccione el Sistema de Notas
                    </h4>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body p-4">
                    <div class="row g-4">
                        <!-- Sistema Tradicional -->
                        <div class="col-md-6">
                            <div class="card h-100 border-0 shadow-sm hvr-grow" style="border-radius: 12px; cursor: pointer; transition: all 0.3s ease;" id="tradicionalNotasCard">
                                <div class="card-header bg-gradient-primary text-white text-center py-3" style="border-radius: 12px 12px 0 0;">
                                    <h5 class="mb-0">
                                        <i class="fas fa-star me-2"></i>SISTEMA TRADICIONAL
                                    </h5>
                                </div>
                                <div class="card-body text-center d-flex flex-column">
                                    <div class="my-3">
                                        <img src="/Recursos/honduras.jpg" class="img-fluid rounded" alt="Bandera de Honduras" style="max-height: 120px; border: 2px solid #e9ecef;">
                                    </div>
                                    <p class="text-muted mb-4">
                                        <i class="fas fa-info-circle me-2"></i>Formato estándar del sistema educativo nacional
                                    </p>
                                    <div class="mt-auto">
                                        <button class="btn btn-primary px-4 rounded-pill" id="tradicionalNotasBtn">
                                            <i class="fas fa-check me-2"></i>Seleccionar
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Sistema Anglosajón -->
                        <div class="col-md-6">
                            <div class="card h-100 border-0 shadow-sm hvr-grow" style="border-radius: 12px; cursor: pointer; transition: all 0.3s ease;" id="anglosajonNotasCard">
                                <div class="card-header bg-gradient-info text-white text-center py-3" style="border-radius: 12px 12px 0 0;">
                                    <h5 class="mb-0">
                                        <i class="fas fa-globe-americas me-2"></i>SISTEMA ANGLOSAJÓN
                                    </h5>
                                </div>
                                <div class="card-body text-center d-flex flex-column">
                                    <div class="my-3">
                                        <img src="/Recursos/eeuu.jpg" class="img-fluid rounded" alt="Bandera de USA" style="max-height: 120px; border: 2px solid #e9ecef;">
                                    </div>
                                    <p class="text-muted mb-4">
                                        <i class="fas fa-info-circle me-2"></i>Formato internacional basado en el sistema educativo americano
                                    </p>
                                    <div class="mt-auto">
                                        <button class="btn btn-info px-4 rounded-pill text-white" id="anglosajonNotasBtn">
                                            <i class="fas fa-check me-2"></i>Seleccionar
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer bg-light">
                    <button type="button" class="btn btn-outline-secondary rounded-pill" data-bs-dismiss="modal">
                        <i class="fas fa-times me-2"></i>Cerrar
                    </button>
                </div>
            </div>
        </div>
    </div>

    @* SCRIPT PARA EL MODAL DE LOS REPORTES   *@
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const tradicionalBtn = document.getElementById('tradicionalBtn');
            const anglosajonBtn = document.getElementById('anglosajonBtn');
            const reportModal = document.getElementById('reportModal');
            const modalInstance = bootstrap.Modal.getInstance(reportModal) || new bootstrap.Modal(reportModal);

            // Efecto al hacer hover en las tarjetas
            const cards = document.querySelectorAll('#reportModal .card');
            cards.forEach(card => {
                card.addEventListener('click', function() {
                    // Efecto visual al seleccionar
                    this.style.transform = 'scale(0.98)';
                    setTimeout(() => {
                        this.style.transform = 'scale(1)';
                    }, 200);
                });
            });

            // Manejo de selección tradicional
            tradicionalBtn.addEventListener('click', function(e) {
                e.preventDefault();
                // Feedback visual
                this.innerHTML = '<i class="fas fa-spinner fa-spin me-2"></i>Redirigiendo...';
                setTimeout(() => {
                    modalInstance.hide();
                    window.location.href = '@Url.Action("Index", "ReporteTradicional")';
                }, 500);
            });

            // Manejo de selección anglosajón
            anglosajonBtn.addEventListener('click', function(e) {
                e.preventDefault();
                // Feedback visual
                this.innerHTML = '<i class="fas fa-spinner fa-spin me-2"></i>Redirigiendo...';
                setTimeout(() => {
                    modalInstance.hide();
                    window.location.href = '@Url.Action("Index", "ReporteAnglosajon")';
                }, 500);
            });
        });
    </script>

    <script>
        // ---------------------------------------
        // Abre el modal de "Personalidad" al hacer clic en su enlace
        // ---------------------------------------
        document.getElementById('btnPersonalidadDropdown').addEventListener('click', function (e) {
            e.preventDefault();  // Prevenir la acción predeterminada del enlace

            // Abre el modal de Personalidad
            var modal = new bootstrap.Modal(document.getElementById('parcialModal'));
            modal.show();
        });

        // ---------------------------------------
        // Prevenir el cierre del dropdown al hacer clic en un ítem (evitar que se cierre cuando se hace clic en Personalidad)
        // ---------------------------------------
        document.querySelectorAll('.dropdown-item').forEach(item => {
            item.addEventListener('click', function (e) {
                // Si el enlace tiene href="#" (como en el caso de "Personalidad"), no hacer nada
                if (this.getAttribute('href') === '#') {
                    e.preventDefault();  // Prevenir la acción predeterminada
                }
            });
        });

        // ---------------------------------------
        // Script para abrir el dropdown al pasar el cursor (mouseenter) y cerrarlo (mouseleave)
        // ---------------------------------------
        // ---------------------------------------
        // Script para abrir el dropdown al pasar el cursor (mouseenter) y cerrarlo (mouseleave)
        // ---------------------------------------
        var dropdownNotas = document.getElementById('navbarDropdown');
        var dropdownTeacher = document.getElementById('navbarDropdownTeacher');

        function setupDropdown(dropdown) {
            var dropdownMenu = dropdown.nextElementSibling;  // El <ul class="dropdown-menu">

            // Mostrar el dropdown al pasar el mouse sobre el enlace
            dropdown.addEventListener('mouseenter', function () {
                var bsDropdown = new bootstrap.Dropdown(dropdown);
                bsDropdown.show();  // Mostrar el dropdown
            });

            // Ocultar el dropdown cuando el cursor sale del área del dropdown
            dropdown.addEventListener('mouseleave', function () {
                var bsDropdown = new bootstrap.Dropdown(dropdown);
                // Solo cerramos si el mouse ha salido de toda la zona del dropdown (el enlace + el menú)
                setTimeout(function () {
                    if (!dropdownMenu.matches(':hover')) {
                        bsDropdown.hide();  // Cerrar el dropdown
                    }
                }, 100);  // Tiempo de espera antes de cerrar
            });
        }

        if (dropdownNotas) {
            setupDropdown(dropdownNotas);
        }

        if (dropdownTeacher) {
            setupDropdown(dropdownTeacher);
        }

        // ---------------------------------------
        // Limpiar la selección cuando se cierra el modal de Personalidad
        // ---------------------------------------
        var modalElement = document.getElementById('parcialModal');
        var modal = new bootstrap.Modal(modalElement);

        modalElement.addEventListener('hidden.bs.modal', function () {
            // Limpiar la selección previa del select al cerrar el modal
            var selectParcial = document.getElementById('selectParcial');
            selectParcial.selectedIndex = 0;  // Restablecer al valor por defecto
        });

        // ---------------------------------------
        // Manejar la selección de un Parcial dentro del modal
        // ---------------------------------------
        document.getElementById('btnSeleccionarParcial').addEventListener('click', function () {
            var selectParcial = document.getElementById('parcialSelect');
            var selectedParcial = selectParcial.value;  // Obtener el valor del parcial seleccionado

            if (selectedParcial) {
                var controller = '';  // Controlador a utilizar
                var area = '';  // Área (si fuera necesario, en este caso lo dejaremos vacío)
                var action = 'Index';  // Acción por defecto

                // Definimos la ruta y el controlador dependiendo del parcial seleccionado
                switch (selectedParcial) {
                    case '1':  // I Parcial
                        controller = 'PersonalidadIParcial';  // Controlador para I Parcial
                        break;
                    case '2':  // II Parcial
                        // toastr.info('Se esta trabajando en este modulo II Parcial.', 'Información');
                        controller = 'PersonalidadIIParcial';  // Controlador para II Parcial
                        break;
                    case '3':  // III Parcial
                        // toastr.info('Se esta trabajando en este modulo III Parcial.', 'Información');
                        controller = 'PersonalidadIIIParcial';  // Controlador para III Parcial
                        break;
                    case '4':  // IV Parcial
                        // toastr.info('Se esta trabajando en este modulo IV Parcial.', 'Información');
                        controller = 'PersonalidadIVParcial';  // Controlador para IV Parcial
                        break;
                    default:
                        alert("Selecciona un parcial válido.");
                        return; // Si no se seleccionó un parcial válido, salimos de la función
                }

                // Generamos la URL dinámica en función de la selección
                var url = '/' + controller + '/' + action;  // La URL se construye como /{controller}/Index

                // Redirigimos al usuario a la URL generada
                window.location.href = url;  // Realiza la redirección a la URL construida
            }
        });

        document.addEventListener('DOMContentLoaded', function () {
            const navLinks = document.querySelectorAll('.navbar-nav .nav-link');

            // Function to update active state
            function updateActiveState() {
                const currentPath = window.location.pathname;
                navLinks.forEach(link => {
                    // Compara la ruta actual con el href del enlace y agrega la clase 'active' solo si coincide
                    if (link.getAttribute('href') === currentPath) {
                        link.classList.add('active');
                    } else {
                        link.classList.remove('active');
                    }
                });
            }

            // Llamar la función de actualización de estado activo al cargar la página
            updateActiveState();
        });

    </script>

    <script>
        // ---------------------------------------
        // Script para seleccionar el sistema en IMPRIMIR NOTAS.
        // ---------------------------------------
            document.addEventListener('DOMContentLoaded', function() {
                const tradicionalNotasBtn = document.getElementById('tradicionalNotasBtn');
                const anglosajonNotasBtn = document.getElementById('anglosajonNotasBtn');
                const notasSystemModal = document.getElementById('notasSystemModal');
                const modalInstance = bootstrap.Modal.getInstance(notasSystemModal) || new bootstrap.Modal(notasSystemModal);

                // Efecto al hacer hover en las tarjetas
                const cards = document.querySelectorAll('#notasSystemModal .card');
                cards.forEach(card => {
                    card.addEventListener('click', function() {
                        // Efecto visual al seleccionar
                        this.style.transform = 'scale(0.98)';
                        setTimeout(() => {
                            this.style.transform = 'scale(1)';
                        }, 200);
                    });
                });

                // Manejo de selección tradicional
                tradicionalNotasBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    // Feedback visual
                    this.innerHTML = '<i class="fas fa-spinner fa-spin me-2"></i>Redirigiendo...';
                    setTimeout(() => {
                        modalInstance.hide();
                        window.location.href = '@Url.Action("Index", "ImprimirNotasTradicional")';
                    }, 500);
                });

                // Manejo de selección anglosajón
                anglosajonNotasBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    // Feedback visual
                    this.innerHTML = '<i class="fas fa-spinner fa-spin me-2"></i>Redirigiendo...';
                    setTimeout(() => {
                        modalInstance.hide();
                        window.location.href = '@Url.Action("Index", "ImprimirNotas")';
                    }, 500);
                });
            });
    </script>


    <script>
        // ---------------------------------------
        // Manejar que el titulo de SYSNARA al darle clic no cargue ninguna otra página.
        // ---------------------------------------
        document.getElementById('myLink').addEventListener('click', function(event) {
          event.preventDefault();
        });
    </script>
    @await RenderSectionAsync("Scripts", required: false)
</body>
</html>
