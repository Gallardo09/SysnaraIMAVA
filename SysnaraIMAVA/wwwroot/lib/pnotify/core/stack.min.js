/**
 * Minified by jsDelivr using Terser v5.3.5.
 * Original file: /npm/@pnotify/core@5.2.0/Stack.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
export default class Stack{constructor(t){if(Object.assign(this,{dir1:null,dir2:null,firstpos1:null,firstpos2:null,spacing1:25,spacing2:25,push:"bottom",maxOpen:1,maxStrategy:"wait",maxClosureCausesWait:!0,modal:"ish",modalishFlash:!0,overlayClose:!0,overlayClosesPinned:!1,positioned:!0,context:window&&document.body||null},t),"ish"===this.modal&&1!==this.maxOpen)throw new Error("A modalish stack must have a maxOpen value of 1.");if("ish"===this.modal&&!this.dir1)throw new Error("A modalish stack must have a direction.");if("top"===this.push&&"ish"===this.modal&&"close"!==this.maxStrategy)throw new Error("A modalish stack that pushes to the top must use the close maxStrategy.");this._noticeHead={notice:null,prev:null,next:null},this._noticeTail={notice:null,prev:this._noticeHead,next:null},this._noticeHead.next=this._noticeTail,this._noticeMap=new WeakMap,this._length=0,this._addpos2=0,this._animation=!0,this._posTimer=null,this._openNotices=0,this._listener=null,this._overlayOpen=!1,this._overlayInserted=!1,this._collapsingModalState=!1,this._leader=null,this._leaderOff=null,this._masking=null,this._maskingOff=null,this._swapping=!1,this._callbacks={}}get notices(){const t=[];return this.forEach((e=>t.push(e))),t}get length(){return this._length}get leader(){return this._leader}forEach(t,{start:e="oldest",dir:i="newer",skipModuleHandled:s=!1}={}){let o;if("head"===e||"newest"===e&&"top"===this.push||"oldest"===e&&"bottom"===this.push)o=this._noticeHead.next;else if("tail"===e||"newest"===e&&"bottom"===this.push||"oldest"===e&&"top"===this.push)o=this._noticeTail.prev;else{if(!this._noticeMap.has(e))throw new Error("Invalid start param.");o=this._noticeMap.get(e)}for(;o.notice;){const e=o.notice;if("prev"===i||"top"===this.push&&"newer"===i||"bottom"===this.push&&"older"===i)o=o.prev;else{if(!("next"===i||"top"===this.push&&"older"===i||"bottom"===this.push&&"newer"===i))throw new Error("Invalid dir param.");o=o.next}if(!(s&&e.getModuleHandled()||!1!==t(e)))break}}close(t){this.forEach((e=>e.close(t,!1,!1)))}open(t){this.forEach((e=>e.open(t)))}openLast(){this.forEach((t=>{if(-1===["opening","open","waiting"].indexOf(t.getState()))return t.open(),!1}),{start:"newest",dir:"older"})}swap(t,e,i=!1,s=!1){return-1===["open","opening","closing"].indexOf(t.getState())?Promise.reject():(this._swapping=e,t.close(i,!1,s).then((()=>e.open(i))).finally((()=>{this._swapping=!1})))}on(t,e){return t in this._callbacks||(this._callbacks[t]=[]),this._callbacks[t].push(e),()=>{this._callbacks[t].splice(this._callbacks[t].indexOf(e),1)}}fire(t,e={}){e.stack=this,t in this._callbacks&&this._callbacks[t].forEach((t=>t(e)))}position(){this.positioned&&this._length>0?(this.fire("beforePosition"),this._resetPositionData(),this.forEach((t=>{this._positionNotice(t)}),{start:"head",dir:"next",skipModuleHandled:!0}),this.fire("afterPosition")):(delete this._nextpos1,delete this._nextpos2)}queuePosition(t=10){this._posTimer&&clearTimeout(this._posTimer),this._posTimer=setTimeout((()=>this.position()),t)}_resetPositionData(){this._nextpos1=this.firstpos1,this._nextpos2=this.firstpos2,this._addpos2=0}_positionNotice(t,e=t===this._masking){if(!this.positioned)return;const i=t.refs.elem;if(!i)return;if(!i.classList.contains("pnotify-in")&&!i.classList.contains("pnotify-initial")&&!e)return;let[s,o,n,a,h]=[this.firstpos1,this.firstpos2,this._nextpos1,this._nextpos2,this._addpos2];i.getBoundingClientRect(),!this._animation||e||this._collapsingModalState?t._setMoveClass(""):t._setMoveClass("pnotify-move");const l=this.context===document.body?window.innerHeight:this.context.scrollHeight,r=this.context===document.body?window.innerWidth:this.context.scrollWidth;let d;if(this.dir1){let t;switch(d={down:"top",up:"bottom",left:"right",right:"left"}[this.dir1],this.dir1){case"down":t=i.offsetTop;break;case"up":t=l-i.scrollHeight-i.offsetTop;break;case"left":t=r-i.scrollWidth-i.offsetLeft;break;case"right":t=i.offsetLeft}null==s&&(s=t,n=s)}if(this.dir1&&this.dir2){const t={down:"top",up:"bottom",left:"right",right:"left"}[this.dir2];let d;switch(this.dir2){case"down":d=i.offsetTop;break;case"up":d=l-i.scrollHeight-i.offsetTop;break;case"left":d=r-i.scrollWidth-i.offsetLeft;break;case"right":d=i.offsetLeft}if(null==o&&(o=d,a=o),!e){const t=n+i.offsetHeight+this.spacing1,e=n+i.offsetWidth+this.spacing1;(("down"===this.dir1||"up"===this.dir1)&&t>l||("left"===this.dir1||"right"===this.dir1)&&e>r)&&(n=s,a+=h+this.spacing2,h=0)}switch(null!=a&&(i.style[t]=a+"px",this._animation||i.style[t]),this.dir2){case"down":case"up":i.offsetHeight+(parseFloat(i.style.marginTop,10)||0)+(parseFloat(i.style.marginBottom,10)||0)>h&&(h=i.offsetHeight);break;case"left":case"right":i.offsetWidth+(parseFloat(i.style.marginLeft,10)||0)+(parseFloat(i.style.marginRight,10)||0)>h&&(h=i.offsetWidth)}}else if(this.dir1){let t,e;switch(this.dir1){case"down":case"up":e=["left","right"],t=this.context.scrollWidth/2-i.offsetWidth/2;break;case"left":case"right":e=["top","bottom"],t=l/2-i.offsetHeight/2}i.style[e[0]]=t+"px",i.style[e[1]]="auto",this._animation||i.style[e[0]]}if(this.dir1)switch(null!=n&&(i.style[d]=n+"px",this._animation||i.style[d]),this.dir1){case"down":case"up":n+=i.offsetHeight+this.spacing1;break;case"left":case"right":n+=i.offsetWidth+this.spacing1}else{const t=r/2-i.offsetWidth/2,e=l/2-i.offsetHeight/2;i.style.left=t+"px",i.style.top=e+"px",this._animation||i.style.left}e||(this.firstpos1=s,this.firstpos2=o,this._nextpos1=n,this._nextpos2=a,this._addpos2=h)}_addNotice(t){this.fire("beforeAddNotice",{notice:t});const e=()=>{if(this.fire("beforeOpenNotice",{notice:t}),t.getModuleHandled())this.fire("afterOpenNotice",{notice:t});else{if(this._openNotices++,("ish"!==this.modal||!this._overlayOpen)&&this.maxOpen!==1/0&&this._openNotices>this.maxOpen&&"close"===this.maxStrategy){let t=this._openNotices-this.maxOpen;this.forEach((e=>{if(-1!==["opening","open"].indexOf(e.getState()))return e.close(!1,!1,this.maxClosureCausesWait),e===this._leader&&this._setLeader(null),t--,!!t}))}!0===this.modal&&this._insertOverlay(),"ish"!==this.modal||this._leader&&-1!==["opening","open","closing"].indexOf(this._leader.getState())||this._setLeader(t),"ish"===this.modal&&this._overlayOpen&&t._preventTimerClose(!0),this.fire("afterOpenNotice",{notice:t})}},i={notice:t,prev:null,next:null,beforeOpenOff:t.on("pnotify:beforeOpen",e),afterCloseOff:t.on("pnotify:afterClose",(()=>{if(this.fire("beforeCloseNotice",{notice:t}),t.getModuleHandled())this.fire("afterCloseNotice",{notice:t});else{if(this._openNotices--,"ish"===this.modal&&t===this._leader&&(this._setLeader(null),this._masking&&this._setMasking(null)),!this._swapping&&this.maxOpen!==1/0&&this._openNotices<this.maxOpen){let e=!1;const i=i=>{if(i!==t&&"waiting"===i.getState()&&(i.open().catch((()=>{})),this._openNotices>=this.maxOpen))return e=!0,!1};"wait"===this.maxStrategy?(this.forEach(i,{start:t,dir:"next"}),e||this.forEach(i,{start:t,dir:"prev"})):"close"===this.maxStrategy&&this.maxClosureCausesWait&&(this.forEach(i,{start:t,dir:"older"}),e||this.forEach(i,{start:t,dir:"newer"}))}this._openNotices<=0?(this._openNotices=0,this._resetPositionData(),this._overlayOpen&&!this._swapping&&this._removeOverlay()):this._collapsingModalState||this.queuePosition(0),this.fire("afterCloseNotice",{notice:t})}}))};if("top"===this.push?(i.next=this._noticeHead.next,i.prev=this._noticeHead,i.next.prev=i,i.prev.next=i):(i.prev=this._noticeTail.prev,i.next=this._noticeTail,i.prev.next=i,i.next.prev=i),this._noticeMap.set(t,i),this._length++,this._listener||(this._listener=()=>this.position(),this.context.addEventListener("pnotify:position",this._listener)),-1!==["open","opening","closing"].indexOf(t.getState()))e();else if("ish"===this.modal&&this.modalishFlash&&this._shouldNoticeWait(t)){const e=t.on("pnotify:mount",(()=>{e(),t._setMasking(!0,!1,(()=>{t._setMasking(!1)})),this._resetPositionData(),this._positionNotice(this._leader),window.requestAnimationFrame((()=>{this._positionNotice(t,!0)}))}))}this.fire("afterAddNotice",{notice:t})}_removeNotice(t){if(!this._noticeMap.has(t))return;this.fire("beforeRemoveNotice",{notice:t});const e=this._noticeMap.get(t);this._leader===t&&this._setLeader(null),this._masking===t&&this._setMasking(null),e.prev.next=e.next,e.next.prev=e.prev,e.prev=null,e.next=null,e.beforeOpenOff(),e.beforeOpenOff=null,e.afterCloseOff(),e.afterCloseOff=null,this._noticeMap.delete(t),this._length--,!this._length&&this._listener&&(this.context.removeEventListener("pnotify:position",this._listener),this._listener=null),!this._length&&this._overlayOpen&&this._removeOverlay(),-1!==["open","opening","closing"].indexOf(t.getState())&&this._handleNoticeClosed(t),this.fire("afterRemoveNotice",{notice:t})}_setLeader(t){if(this.fire("beforeSetLeader",{leader:t}),this._leaderOff&&(this._leaderOff(),this._leaderOff=null),this._leader=t,!this._leader)return void this.fire("afterSetLeader",{leader:t});const e=()=>{let t=null;this._overlayOpen&&(this._collapsingModalState=!0,this.forEach((e=>{e._preventTimerClose(!1),e!==this._leader&&-1!==["opening","open"].indexOf(e.getState())&&(t||(t=e),e.close(e===t,!1,!0))}),{start:this._leader,dir:"next",skipModuleHandled:!0}),this._removeOverlay()),i&&(clearTimeout(i),i=null),this.forEach((e=>{if(e!==this._leader)return"waiting"===e.getState()||e===t?(this._setMasking(e,!!t),!1):void 0}),{start:this._leader,dir:"next",skipModuleHandled:!0})};let i=null;const s=()=>{i&&(clearTimeout(i),i=null),i=setTimeout((()=>{i=null,this._setMasking(null)}),750)};var o;this._leaderOff=(o=[this._leader.on("mouseenter",e),this._leader.on("focusin",e),this._leader.on("mouseleave",s),this._leader.on("focusout",s)],()=>o.map((t=>t()))),this.fire("afterSetLeader",{leader:t})}_setMasking(t,e){if(this._masking){if(this._masking===t)return;this._masking._setMasking(!1,e)}if(this._maskingOff&&(this._maskingOff(),this._maskingOff=null),this._masking=t,!this._masking)return;this._resetPositionData(),this._leader&&this._positionNotice(this._leader),this._masking._setMasking(!0,e),window.requestAnimationFrame((()=>{this._masking&&this._positionNotice(this._masking)}));const i=()=>{"ish"===this.modal&&(this._insertOverlay(),this._setMasking(null,!0),this.forEach((t=>{t._preventTimerClose(!0),"waiting"===t.getState()&&t.open()}),{start:this._leader,dir:"next",skipModuleHandled:!0}))};var s;this._maskingOff=(s=[this._masking.on("mouseenter",i),this._masking.on("focusin",i)],()=>s.map((t=>t())))}_shouldNoticeWait(t){return this._swapping!==t&&!("ish"===this.modal&&this._overlayOpen)&&this.maxOpen!==1/0&&this._openNotices>=this.maxOpen&&"wait"===this.maxStrategy}_insertOverlay(){this._overlay||(this._overlay=document.createElement("div"),this._overlay.classList.add("pnotify-modal-overlay"),this.dir1&&this._overlay.classList.add("pnotify-modal-overlay-"+this.dir1),this.overlayClose&&this._overlay.classList.add("pnotify-modal-overlay-closes"),this.context!==document.body&&(this._overlay.style.height=this.context.scrollHeight+"px",this._overlay.style.width=this.context.scrollWidth+"px"),this._overlay.addEventListener("click",(t=>{if(this.overlayClose){if(this.fire("overlayClose",{clickEvent:t}),t.defaultPrevented)return;this._leader&&this._setLeader(null),this.forEach((t=>{-1===["closed","closing","waiting"].indexOf(t.getState())&&(t.hide||this.overlayClosesPinned?t.close():t.hide||"ish"!==this.modal||(this._leader?t.close(!1,!1,!0):this._setLeader(t)))}),{skipModuleHandled:!0}),this._overlayOpen&&this._removeOverlay()}}))),this._overlay.parentNode!==this.context&&(this.fire("beforeAddOverlay"),this._overlay.classList.remove("pnotify-modal-overlay-in"),this._overlay=this.context.insertBefore(this._overlay,this.context.firstChild),this._overlayOpen=!0,this._overlayInserted=!0,window.requestAnimationFrame((()=>{this._overlay.classList.add("pnotify-modal-overlay-in"),this.fire("afterAddOverlay")}))),this._collapsingModalState=!1}_removeOverlay(){this._overlay.parentNode&&(this.fire("beforeRemoveOverlay"),this._overlay.classList.remove("pnotify-modal-overlay-in"),this._overlayOpen=!1,setTimeout((()=>{this._overlayInserted=!1,this._overlay.parentNode&&(this._overlay.parentNode.removeChild(this._overlay),this.fire("afterRemoveOverlay"))}),250),setTimeout((()=>{this._collapsingModalState=!1}),400))}}
//# sourceMappingURL=/sm/c30ae2ad11891830e30e5f7095023a44efe299ccd287ef4d17897752b29c2e06.map